Starting job on cn-m003.server.mila.quebec
SLURM_JOB_ID 8101047
submitit INFO (2025-11-12 14:34:19,633) - Starting with JobEnvironment(job_id=8101047, hostname=cn-m003.server.mila.quebec, local_rank=0(1), node=0(1), global_rank=0(1))
submitit INFO (2025-11-12 14:34:19,634) - Loading pickle: /network/scratch/c/cesar.valdez/manyLatents/logs/single_algorithm_pca_swissroll/multiruns/2025-11-12/14-33-30/.submitit/8101047/8101047_submitted.pkl
[11/12/25 14:35:01] INFO     Final Config:                     experiment.py:325
                             algorithms:                                        
                               latent:                                          
                                 _target_:                                      
                             manylatents.algorithms.latent.pca                  
                             .PCAModule                                         
                                 n_components: 2                                
                                 random_state: ${seed}                          
                             pipeline: []                                       
                             data:                                              
                               batch_size: 128                                  
                               num_workers: 1                                   
                               shuffle_traindata: false                         
                               _target_:                                        
                             manylatents.data.swissroll.SwissR                  
                             ollDataModule                                      
                               test_split: 0.2                                  
                               n_distributions: 10                              
                               n_points_per_distribution: 100                   
                               noise: 0.2                                       
                               manifold_noise: 0.2                              
                               width: 10.0                                      
                               random_state: ${seed}                            
                               rotate_to_dim: 100                               
                               mode: full                                       
                               use_gap: false                                   
                               n_gaps: 3                                        
                               gap_fraction: 0.3                                
                             callbacks:                                         
                               embedding:                                       
                                 save_embeddings:                               
                                   _target_:                                    
                             manylatents.callbacks.embedding.s                  
                             ave_embeddings.SaveEmbeddings                      
                                   save_dir:                                    
                             ${hydra:runtime.output_dir}                        
                                   save_format: csv                             
                                   experiment_name: ${name}                     
                                   save_metric_tables: false                    
                                 plot_embeddings:                               
                                   _target_:                                    
                             manylatents.callbacks.embedding.p                  
                             lot_embeddings.PlotEmbeddings                      
                                   save_dir:                                    
                             ${hydra:runtime.output_dir}                        
                                   experiment_name:                             
                             ${name}.png                                        
                                   figsize:                                     
                                   - 8                                          
                                   - 6                                          
                                   label_col: Population                        
                                   legend: false                                
                                   color_by_score: null                         
                                 wandb_log_scores:                              
                                   _target_:                                    
                             manylatents.callbacks.embedding.w                  
                             andb_log_scores.WandbLogScores                     
                                   log_summary: true                            
                                   log_table: true                              
                                   log_k_curve_table: true                      
                                   include_labels: false                        
                             logger: null                                       
                             trainer: {}                                        
                             metrics:                                           
                               dataset:                                         
                                 test_metric:                                   
                                   _target_:                                    
                             manylatents.metrics.test_metric.T                  
                             estMetric                                          
                                   _partial_: true                              
                                   k: 25                                        
                               embedding:                                       
                                 test_metric:                                   
                                   _target_:                                    
                             manylatents.metrics.test_metric.T                  
                             estMetric                                          
                                   _partial_: true                              
                                   k: 25                                        
                               module:                                          
                                 test_metric:                                   
                                   _target_:                                    
                             manylatents.metrics.test_metric.T                  
                             estMetric                                          
                                   _partial_: true                              
                                   k: 25                                        
                             log_level: info                                    
                             seed: 42                                           
                             debug: false                                       
                             verbose: false                                     
                             cache_dir: outputs/cache                           
                             ckpt_dir: outputs/ckpt                             
                             name:                                              
                             single_algorithm_pca_swissroll                     
                             project: your_project                              
                             eval_only: false                                   
                             pretrained_ckpt: null                              
                                                                                
                    INFO     WandB disabled: logger=None        experiment.py:49
                             (orchestrated by parent)                           
                    INFO     WandB logging disabled - skipping experiment.py:338
                             wandb initialization                               
                    INFO     Cache directory ensured at:        experiment.py:67
                             outputs/cache                                      
[11/12/25 14:35:02] INFO     SaveEmbeddings initialized    save_embeddings.py:64
                             with directory:                                    
                             /network/scratch/c/cesar.vald                      
                             ez/manyLatents/logs/single_al                      
                             gorithm_pca_swissroll/multiru                      
                             ns/2025-11-12/14-33-30/0 and                       
                             format: csv                                        
                    INFO     PlotEmbeddings initialized    plot_embeddings.py:67
                             with directory:                                    
                             /network/scratch/c/cesar.vald                      
                             ez/manyLatents/logs/single_al                      
                             gorithm_pca_swissroll/multiru                      
                             ns/2025-11-12/14-33-30/0 and                       
                             experiment name:                                   
                             single_algorithm_pca_swissrol                      
                             l.png                                              
                    INFO     Trainer loggers disabled (WandB   experiment.py:380
                             disabled)                                          
                    INFO     Starting algorithm execution...   experiment.py:389
                    INFO     Running algorithm on using        experiment.py:402
                             unified data:                                      
                             Train tensor shape:                                
                             torch.Size([1000, 100])                            
                             Test tensor shape:                                 
                             torch.Size([1000, 100])                            
                             Algorithm: PCAModule                               
                    INFO     LatentModule embedding shape:     experiment.py:265
                             torch.Size([1000, 2])                              
                    INFO     Evaluating embeddings from        experiment.py:432
                             PCAModule...                                       
                    INFO     Reference data shape: (1000, 100) experiment.py:171
                    INFO     Computing embedding metrics for   experiment.py:172
                             1000 samples.                                      
                    INFO     Saving embeddings with shape save_embeddings.py:102
                             (1000, 2) to                                       
                             /network/scratch/c/cesar.val                       
                             dez/manyLatents/logs/single_                       
                             algorithm_pca_swissroll/mult                       
                             iruns/2025-11-12/14-33-30/0/                       
                             embeddings_single_algorithm_                       
                             pca_swissroll_20251112_14350                       
                             2.csv                                              
                    INFO     Output registered under key:             base.py:56
                             saved_embeddings                                   
                    INFO     Callback SaveEmbeddings returned: experiment.py:448
                             ['saved_embeddings']                               
                    INFO     Saved 2D embeddings plot to  plot_embeddings.py:191
                             /network/scratch/c/cesar.val                       
                             dez/manyLatents/logs/single_                       
                             algorithm_pca_swissroll/mult                       
                             iruns/2025-11-12/14-33-30/0/                       
                             embedding_plot_single_algori                       
                             thm_pca_swissroll.png_202511                       
                             12_143502.png                                      
                    INFO     WandB upload skipped (no     plot_embeddings.py:200
                             active run)                                        
                    INFO     Output registered under key:             base.py:56
                             embedding_plot_path                                
                    INFO     Callback PlotEmbeddings returned: experiment.py:448
                             ['embedding_plot_path']                            
                    INFO     Callback WandbLogScores returned: experiment.py:448
                             []                                                 
                    INFO     Added callback outputs to         experiment.py:453
                             embeddings: ['saved_embeddings',                   
                             'embedding_plot_path']                             
                    INFO     Experiment complete.              experiment.py:455
submitit INFO (2025-11-12 14:35:02,689) - Job completed successfully
                    INFO     Job completed successfully         submission.py:56
submitit INFO (2025-11-12 14:35:02,698) - Exiting after successful completion
                    INFO     Exiting after successful           submission.py:61
                             completion                                         
